# v3.1 修改补丁 - 新文档写作模式的Cursor协作机制

## 修改说明

**修改类型**：补充（不删除任何现有内容）
**修改位置**：在"模式4：新文档写作"章节中
**插入位置**：在"场景C：AI竞品分析"说明之后，"框架指南对齐机制"之前
**字数**：约500字
**目的**：明确新文档写作模式默认使用Cursor执行，提供标准模板

---

## 具体插入位置

在v3.1指令中找到以下内容：

```markdown
**场景C：AI竞品分析（新增）**

- 框架：优先调用 `AI产品分析/AI产品竞品分析/00_系统指令/Claude-竞品分析主指令.md`
  ...
  
**Step 12：交付文档**
使用present_files工具交付Step9完整报告

<!-- 【在此处插入新内容】 -->

**框架指南对齐机制**：
- 每次启动新文档写作模式时，MUST使用`project_knowledge_search`搜索《新文档写作框架指南》
...
```

---

## 插入内容

在上述位置插入以下内容：

```markdown
---

### 🤝 新文档写作模式的Cursor协作机制（v3.1补充）

#### 核心原则

**新文档写作模式（场景A/B/C）默认使用Cursor执行写作**

原因：
- 避免Claude重复输出大文件内容，浪费Token
- Cursor可以更好地读取多个仓库文档并整合
- 用户可以直接在本地编辑Cursor生成的文件

#### 标准工作流程

```
用户触发新文档写作模式（【写作】/【案例】/【竞品】）
↓
Claude：调研（project_knowledge_search搜索相关理论和案例）
↓
Claude：讨论（与用户确认框架、结构、引用文档）
↓
Claude：生成Cursor指令（使用7部分标准模板，见下）
↓
Claude：present_files交付Cursor指令
↓
用户：复制Cursor指令到Cursor执行
↓
Cursor：读取引用文档 + 执行写作 + 保存到指定位置
```

#### Cursor指令7部分标准模板

Claude生成Cursor指令时，MUST包含以下7个部分：

```markdown
# Cursor写作任务

## 1. 任务目标
[明确说明：写什么文档、目标读者、核心目的、篇幅要求]

## 2. 核心框架
[提供文档结构大纲，清晰的章节划分]

## 3. 引用文档（重要）
**请从以下路径读取并引用**：
- 路径1: `/path/to/doc1.md` - 用于论证XXX
- 路径2: `/path/to/doc2.md` - 用于对比XXX

## 4. 关键要点
- 核心论点1：[说明]
- 必须包含的数据/案例：[列举]

## 5. 写作要求
- 证据标注：事实/推断/待验证
- 字数要求：[具体字数]
- 特殊要求：[YAML索引、表格等]

## 6. 输出位置
[完整文件路径]

## 7. 质量检查清单
[列出必须满足的检查项]
```

#### 何时例外（Claude自己写）

仅在以下情况下，Claude可以自己写完整内容而不生成Cursor指令：

- ✅ 用户明确要求"现在就给我看内容"
- ✅ 文档<500字且不需要引用多个仓库文档
- ✅ 纯讨论、框架确认（不生成文件）
- ✅ 用户说"先写一段让我看看"（预览性质）

#### 与Token优化系统的关系

本节是"Token优化系统"中"优化4-6"（Claude与Cursor分工）的具体应用。

详细的Cursor协作规则，请参考本指令中的"Token优化系统"章节：
- 优化4：Claude与Cursor的分工表
- 优化5：大文件处理流程（>500字）
- 优化6：Cursor指令的正确写法
- 禁止行为清单

#### 场景A/B/C的Cursor指令差异

**场景A（理论/方法论）**：
- 强调：7步法框架、YAML索引生成、17项质量检查
- 引用文档：主要是理论文档（02-shu/、01-dao/）

**场景B（商业案例）**：
- 强调：7步法（时空还原→迁移应用）、证据标注、通用启发
- 引用文档：理论文档 + 对比案例

**场景C（AI竞品）**：
- 强调：10步流程、子指令调用、评分系统
- 引用文档：竞品分析主指令 + 导师点评指令 + 评分系统指令

#### 示例：正确的Cursor指令生成

**用户请求**：
"【案例】写一篇Tesla深度分析"

**Claude执行**：
1. ✅ 搜索相关理论（创新三元法、从0到1、破坏式创新等）
2. ✅ 与用户讨论框架（确认7步法、引用哪些理论）
3. ✅ 生成Cursor指令（7个部分完整，列出5个引用文档路径）
4. ✅ present_files交付Cursor指令
5. ❌ **不自己写8000字完整文档**

---
```

---

## 修改后的效果

### Before（v3.1现状）

```markdown
**场景C：AI竞品分析（新增）**
...

**框架指南对齐机制**：
...
```

**问题**：
- 场景A/B/C说明完后，直接跳到"框架指南对齐"
- 没有明确说"应该生成Cursor指令"
- Claude可能自己写完整文档

---

### After（修改后）

```markdown
**场景C：AI竞品分析（新增）**
...

### 🤝 新文档写作模式的Cursor协作机制（v3.1补充）
[插入上述500字内容]

**框架指南对齐机制**：
...
```

**效果**：
- ✅ 场景A/B/C说明完后，立即说明"默认用Cursor"
- ✅ 提供7部分标准模板
- ✅ 说明何时例外
- ✅ Claude每次执行新文档写作模式时，会自动生成Cursor指令

---

## 验证清单

修改完成后，请验证：

- [ ] 插入位置正确（在场景C之后，框架指南之前）
- [ ] 没有删除任何现有内容
- [ ] 7部分标准模板完整
- [ ] 说明了何时例外
- [ ] 引用了Token优化系统章节

---

## 下一步

1. **复制上述"插入内容"**（从"---"到"---"之间的内容）
2. **粘贴到v3.1指令的指定位置**
3. **保存修改后的v3.1**
4. **测试效果**：让Claude执行一次"【案例】写一篇XXX"，看是否自动生成Cursor指令

---

## 补充说明

### 为什么插入在这个位置？

**理由**：
- 场景A/B/C刚说明完，用户理解了三个场景
- 立即告诉用户"这三个场景都默认用Cursor"
- 避免用户以为"Claude会自己写完整文档"

### 为什么要引用Token优化系统？

**理由**：
- 避免重复内容
- Token优化系统中有详细的禁止行为清单
- 保持v3.1指令的内部一致性

### 为什么要说明"何时例外"？

**理由**：
- 有些情况下，用户确实需要立即看到内容（预览）
- 给Claude灵活性，避免过于僵化
- 明确例外情况，避免Claude困惑

---

> **修改补丁版本**：v3.1.1 | **修改日期**：2025-01-01 | **修改类型**：补充（新增Cursor协作机制说明）
